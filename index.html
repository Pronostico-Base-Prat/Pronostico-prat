<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pron√≥stico Meteorol√≥gico - Base Prat</title>
    <style>
        body { font-family: sans-serif; background: #e3effb; margin: 0; padding: 0; }
        header { background: #003366; color: white; text-align: center; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
        .etiqueta-dia { background: #3498db; color: white; padding: 10px 30px; border-radius: 50px; font-weight: bold; display: inline-block; margin: 20px auto; }
        .contenedor-clima { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; padding: 10px; }
        .tarjeta { background: white; border-radius: 12px; padding: 20px; width: 280px; box-shadow: 0 8px 16px rgba(0,0,0,0.1); border-top: 10px solid #003366; }
        h2 { margin: 0 0 10px 0; color: #003366; border-bottom: 2px solid #eee; padding-bottom: 5px; text-align: center; }
        .dato { margin: 8px 0; color: #333; font-size: 0.95rem; }
        .temp { font-size: 1.1rem; color: #d35400; font-weight: bold; margin-top: 15px; border-top: 1px dashed #ccc; padding-top: 10px; }
    </style>
</head>
<body>
    <header>
        <h1>Base Naval Ant√°rtica "Capit√°n Arturo Prat"</h1>
        <p>Pron√≥stico Meteorol√≥gico - Puerto Soberan√≠a</p>
    </header>
    <div id="contenido-principal" style="text-align: center;">
        <p style="padding: 50px;">Cargando datos meteorol√≥gicos...</p>
    </div>

    <script>
        // ENLACE REVISADO CAR√ÅCTER POR CAR√ÅCTER
        const enlaceCSV = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQrxJhBvpk3JZuOMWpKPZ2PMi2DYFEjxhSTWMbx4i_EHHI6rh9frJuskRuaX-OXJqc_Akz6Dh5qLr72/pub?output=csv";

        async function cargarClima() {
            try {
                const respuesta = await fetch(enlaceCSV);
                const texto = await respuesta.text();
                
                // Funci√≥n para separar por comas respetando el texto entre comillas
                const filas = texto.split('\n').map(linea => {
                    const res = [];
                    let curr = '', inQuotes = false;
                    for (let char of linea) {
                        if (char === '"') inQuotes = !inQuotes;
                        else if (char === ',' && !inQuotes) { res.push(curr.trim()); curr = ''; }
                        else curr += char;
                    }
                    res.push(curr.trim());
                    return res;
                }).filter(f => f.length > 3 && f[0] !== "");

                const main = document.getElementById('contenido-principal');
                main.innerHTML = ""; 

                let diaActual = "";
                let contenedorActual = null;

                for (let i = 1; i < filas.length; i++) {
                    const col = filas[i];
                    if (col[0] !== diaActual) {
                        diaActual = col[0];
                        const divDia = document.createElement('div');
                        divDia.style.width = "100%";
                        divDia.innerHTML = <div class="etiqueta-dia">${diaActual}</div>;
                        main.appendChild(divDia);

                        contenedorActual = document.createElement('div');
                        contenedorActual.className = 'contenedor-clima';
                        main.appendChild(contenedorActual);
                    }

                    contenedorActual.innerHTML += `
                        <div class="tarjeta">
                            <h2>${col[1] || '---'}</h2>
                            <p class="dato">‚òÅÔ∏è <strong>Cielo:</strong> ${col[2] || '---'}</p>
                            <p class="dato">üëÅÔ∏è <strong>Vis:</strong> ${col[3] || '---'}</p>
                            <p class="dato">üå¨Ô∏è <strong>Viento:</strong> ${col[4] || '---'}</p>
                            <p class="dato">üåä <strong>Mar:</strong> ${col[5] || '---'}</p>
                            <p class="temp">üå°Ô∏è Aire: ${col[6] || '---'} | ST: ${col[7] || '---'}</p>
                            <p class="dato">‚ö†Ô∏è <strong>Riesgo:</strong> ${col[8] || 'Bajo'}</p>
                        </div>
                    `;
                }
            } catch (error) {
                document.getElementById('contenido-principal').innerHTML = "<p style='padding:50px;'>Error al conectar. Verifica la conexi√≥n a internet.</p>";
            }
        }
        cargarClima();
    </script>
</body>
</html>
