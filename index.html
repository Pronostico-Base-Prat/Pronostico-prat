<script>
    // URL de tus dos hojas (Clima y Mareas)
    const URL_CLIMA = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQRxJhBvpk3JZu0MWpKPZ2PMi2DYfEjxhSTWMbX4i_EHHI6rh9frJuskRuaX-OXJqc_Akz6Dh5qLr72/pub?gid=0&output=csv";
    const URL_MAREAS = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQRxJhBvpk3JZu0MWpKPZ2PMi2DYfEjxhSTWMbX4i_EHHI6rh9frJuskRuaX-OXJqc_Akz6Dh5qLr72/pub?gid=2017374824&output=csv";

    async function cargarTodo() {
        // --- 1. CARGAR PRONÓSTICO (Ya lo tienes funcionando) ---
        try {
            const resC = await fetch(URL_CLIMA + "&v=" + Date.now());
            const csvC = await resC.text();
            // ... (tu código actual de tarjetas que ya funciona bien) ...
        } catch(e) { console.log("Error Clima", e); }

        // --- 2. CARGAR Y RELLENAR TABLA DE MAREAS ---
        try {
            const resM = await fetch(URL_MAREAS + "&v=" + Date.now());
            const csvM = await resM.text();
            const filasM = csvM.split('\n').map(r => r.split(','));
            
            let tablaHtml = "";
            // Empezamos en i=2 para saltar el título "Mes de Febrero" y los encabezados
            for(let i=2; i<filasM.length; i++) {
                const m = filasM[i].map(v => v.replace(/"/g, '').trim());
                if(!m[0]) continue; // Salta filas vacías

                tablaHtml += `
                    <tr>
                        <td><b>${m[0]}</b></td>
                        <td>${m[1]}</td><td class="${m[2].includes('P')?'p-mareas':'b-mareas'}">${m[2]}</td>
                        <td>${m[3]}</td><td class="${m[4].includes('P')?'p-mareas':'b-mareas'}">${m[4]}</td>
                        <td>${m[5]}</td><td class="${m[6].includes('P')?'p-mareas':'b-mareas'}">${m[6]}</td>
                        <td>${m[7]}</td><td class="${m[8].includes('P')?'p-mareas':'b-mareas'}">${m[8]}</td>
                    </tr>`;
            }
            // Insertamos las filas en el cuerpo de la tabla
            document.getElementById('cuerpo-mareas').innerHTML = tablaHtml;
        } catch(e) { 
            console.log("Error Mareas", e);
            document.getElementById('cuerpo-mareas').innerHTML = "<tr><td colspan='9'>Error al cargar datos de mareas</td></tr>";
        }
    }

    cargarTodo();
    // Refrescar cada 5 minutos
    setInterval(cargarTodo, 300000);
</script>
